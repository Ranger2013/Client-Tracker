// @ts-nocheck
import{buildElementTree}from"../../../../../../utils/dom/elements.js";export default function buildHorseTypesWidget(t){const{horseTypes:e,totalActiveHorses:n}=t,r=n,a={draft:"#76b7b2",horse:"#4e79a7",mule:"#af7aa1",donkey:"#f28e2c",mini_donkey:"#59a14f",pony:"#e15759",mini_pony:"#edc949"},i=Object.entries(e).filter((([t,e])=>e>0)).map((([t,e])=>({type:t,count:e,rawPercentage:e/r*100}))).sort(((t,e)=>e.count-t.count)),s=i.reduce(((t,e)=>t+Math.max(1,Math.round(e.rawPercentage))),0),o=s>100?100/s:1;i.forEach((t=>{t.percentage=Math.round(Math.max(1,Math.round(t.rawPercentage))*o)}));let c=100-i.reduce(((t,e)=>t+e.percentage),0);if(0!==c){i.sort(((t,e)=>e.count-t.count));let t=0;for(;0!==c&&t<i.length;)i[t].percentage+=c>0?1:-1,c+=c>0?-1:1,t++;i.sort(((t,e)=>e.count-t.count))}const l=generatePieChartSlices(i,a),d={type:"div",children:[{type:"div",myClass:["w3-card","w3-round","w3-margin-bottom"],children:[{type:"h4",myClass:["w3-center"],text:"Horse Types Distribution"},{type:"div",myClass:["w3-center"],text:`<strong>Total Horses:</strong> ${r}`}]},{type:"div",myClass:["w3-card","w3-round","w3-padding-small","w3-margin-bottom","w3-center"],children:[{type:"div",myClass:["w3-center"],attributes:{id:"pie-chart-container",style:"max-width: 350px; margin: 0 auto;"},text:`\n\t\t\t\t\t\t\t\t\t<svg viewBox="0 0 100 100" class="w3-center">\n\t\t\t\t\t\t\t\t\t\t \x3c!-- Pie slices --\x3e\n\t\t\t\t\t\t\t\t\t\t ${l.pathsHTML}\n\t\t\t\t\t\t\t\t\t\t \x3c!-- Center circle (optional for donut chart) --\x3e\n\t\t\t\t\t\t\t\t\t\t <circle cx="50" cy="50" r="25" fill="white"></circle>\n\t\t\t\t\t\t\t\t\t\t <text x="50" y="50" text-anchor="middle" dominant-baseline="middle" \n\t\t\t\t\t\t\t\t\t\t\t\t font-size="6" font-weight="bold">Horse Types</text>\n\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t  `}]},{type:"div",myClass:["w3-card","w3-round","w3-padding-small"],children:[{type:"div",myClass:["w3-row"],children:buildLegendItems(i,a)}]}]};return buildElementTree(d)}function generatePieChartSlices(t,e){let n=0;const r=[],a=40;return t.forEach((t=>{if(0===t.count)return;const i=t.percentage/100*360,s=n+i,o=(n-90)*Math.PI/180,c=(s-90)*Math.PI/180,l=`\n\t\t\t  <path \n\t\t\t\t\td="M 50,50 L ${50+a*Math.cos(o)},${50+a*Math.sin(o)} A 40,40 0 ${i>180?1:0},1 ${50+a*Math.cos(c)},${50+a*Math.sin(c)} Z" \n\t\t\t\t\tfill="${e[t.type]||"#ccc"}"\n\t\t\t\t\tstroke="white" \n\t\t\t\t\tstroke-width="0.5"\n\t\t\t  ></path>\n\t\t `;r.push(l),n=s})),{pathsHTML:r.join("")}}function buildLegendItems(t,e){return t.map((t=>({type:"div",myClass:["w3-col","s6","m4"],children:[{type:"div",myClass:["w3-padding-small"],children:[{type:"span",attributes:{style:`display:inline-block; width:15px; height:15px; background-color:${e[t.type]}; margin-right:5px; border-radius:2px; vertical-align:middle;`}},{type:"span",myClass:["w3-small"],text:`${formatHorseType(t.type)}: `},{type:"div",myClass:["w3-indent","w3-small"],text:`${t.count} (${t.percentage}%)`}]}]})))}function formatHorseType(t){return t.split("_").map((t=>t.charAt(0).toUpperCase()+t.slice(1))).join(" ")}