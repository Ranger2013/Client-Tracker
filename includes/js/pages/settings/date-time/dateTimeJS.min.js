// @ts-nocheck
import ManageUser from"../../../classes/ManageUser.js";import setupBackupNotice from"../../../utils/backup-notice/backupNotice.js";import{myError,mySuccess}from"../../../utils/dom/domUtils.js";import{validateDateFormat,validateTimeZone}from"../../../utils/validation/validationUtils.js";import populateDateTimeForm from"./helpers/populateDateTimeForm.js";const manageUser=new ManageUser;setupBackupNotice();const dateTimeForm=document.getElementById("date-time-form"),timeZone=document.getElementById("time-zone"),timeZoneError=document.getElementById("time-zone-error"),dateFormat=document.getElementById("date-format"),dateFormatError=document.getElementById("date-format-error"),fm=document.getElementById("form-msg");async function handleFormSubmission(e){e.preventDefault();try{mySuccess(fm,"Processing...","w3-text-blue");const t=Object.fromEntries(new FormData(e.target));await manageUser.updateLocalUserSettings({userData:t,settingsProperty:"date_time",backupStore:manageUser.indexed.stores.DATETIME,backupAPITag:"add_date_time"})?mySuccess(fm,"Date/Time Options have been saved."):myError(fm,"We were unable to save your Date/Time Options.<br>Please submit a new Help Desk Ticket for this issue.")}catch(e){console.warn("Error adding date time options for user: ",e),myError(fm,"Something went wrong.");const{default:t}=await import("../../../utils/error-messages/errorLogs.js");await t("dateTimeFormSubmissionError","Date/Time Form Submission Error:",e)}}populateDateTimeForm(manageUser,{timeZone:timeZone,dateFormat:dateFormat}),dateFormat.addEventListener("change",(e=>validateDateFormat(e,dateFormatError))),timeZone.addEventListener("change",(e=>validateTimeZone(e,timeZoneError))),dateTimeForm.addEventListener("submit",handleFormSubmission);