// @ts-nocheck
import IndexedDBOperations from"../../../classes/IndexedDBOperations.js";import{clearMsg}from"../../dom/domUtils.js";import errorLogs from"../../error-messages/errorLogs.js";export default async function validatePhone({evt:e}){try{if(!e.target.value)return"Phone number is required.";const r=formatPhone(e.target.value);return r?(e.target.value=r,r&&await checkForDuplicateNumbers(e.target.value)?"Phone number is not available.":void clearMsg({container:`${e.target.id}-error`,hide:!0,input:e.target})):"Please use the correct format."}catch(e){throw await errorLogs("validatePhoneError","Validate phone error: ",e),e}}function formatPhone(e){let r=(""+e).replace(/\D/g,"").match(/^(\d{3})(\d{3})(\d{4})$/);return r?`${r[1]}-${r[2]}-${r[3]}`:null}async function checkForDuplicateNumbers(e){try{const r=new IndexedDBOperations,t=await r.openDBPromise(),o=await r.getAllStorePromise(t,r.stores.CLIENTLIST);return o.some((r=>r.phone===e))}catch(e){throw await errorLogs("validatePhoneError","Validate phone error: ",e),e}}