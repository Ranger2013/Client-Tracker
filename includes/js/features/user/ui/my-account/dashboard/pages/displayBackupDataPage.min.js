// @ts-nocheck
import{addListener}from"../../../../../../core/utils/dom/listeners.js";import{clearMsg}from"../../../../../../core/utils/dom/messages.js";import buildObjectStoreRows from"../components/backup-data/buildObjectStoreRows.js";import buildBackupDataPageComponents from"../components/backup-data/buildPageComponents.js";const COMPONENT_ID="backup-data-tab";export default async function displayBackupDataPage({evt:e,messageContainer:a,tabContainer:r,manageUser:t}){try{clearMsg({container:"form-msg"}),clearMsg({container:"page-msg"});const e=await buildObjectStoreRows({manageUser:t}),a=buildBackupDataPageComponents({manageUser:t,objectStoreRows:e});a.querySelector("#display-container").appendChild(e),r.innerHTML="",r.appendChild(a);const o=r.querySelector("#submit-button");if(!o)return;const{default:s}=await import("../components/backup-data/backupDataToServer");addListener({elementOrId:o,eventType:"click",handler:async e=>{try{await s({tabContainer:r})}catch(e){const{AppError:a}=await import("../../../../../../core/errors/models/AppError.min.js");a.handleError(e,{errorCode:a.Types.DATABASE_ERROR,userMessage:a.BaseMessages.system.network})}},componentId:COMPONENT_ID});const n=new IndexedDBOperations,c=await n.openDBPromise();try{await n.addStorePromise(c,data,store)}catch(e){console.error("Failed to add data:",e)}}catch(e){const{AppError:a}=await import("../../../../../../core/errors/models/AppError.min.js");a.process(e,{errorCode:a.Types.RENDER_ERROR,userMessage:a.BaseMessages.system.render},!0)}}