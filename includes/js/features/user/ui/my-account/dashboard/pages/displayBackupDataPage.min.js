// @ts-nocheck
import{addListener}from"../../../../../../core/utils/dom/listeners.js";import{clearMsg}from"../../../../../../core/utils/dom/messages.js";import buildObjectStoreRows from"../components/backup-data/buildObjectStoreRows.js";import buildPageComponents from"../components/backup-data/buildPageComponents.js";const COMPONENT_ID="backup-data-tab";export default async function displayBackupDataPage({evt:e,messageContainer:r,tabContainer:a,manageUser:o}){try{clearMsg({container:"form-msg"}),clearMsg({container:"page-msg"});const e=await buildObjectStoreRows({manageUser:o}),r=buildPageComponents({manageUser:o,objectStoreRows:e});r.querySelector("#display-container").appendChild(e),a.innerHTML="",a.appendChild(r);const t=a.querySelector("#submit-button");if(!t)return;const{default:s}=await import("../components/backup-data/backupDataToServer");addListener({elementOrId:t,eventType:"click",handler:async e=>{try{await s({tabContainer:a})}catch(e){const{AppError:r}=await import("../../../../../../core/errors/models/AppError.js");r.handleError(e,{errorCode:r.Types.DATABASE_ERROR,userMessage:r.BaseMessages.system.network})}},componentId:COMPONENT_ID});const n=new IndexedDBOperations,c=await n.openDBPromise();try{await n.addStorePromise(c,data,store)}catch(e){console.error("Failed to add data:",e)}}catch(e){const{AppError:r}=await import("../../../../../../core/errors/models/AppError.js");r.process(e,{errorCode:r.Types.RENDER_ERROR,userMessage:r.BaseMessages.system.render},!0)}}