// @ts-nocheck
import{addListener}from"../../../../core/utils/dom/listeners.js";import{clearMsg,safeDisplayMessage}from"../../../../core/utils/dom/messages.js";import{disableEnableSubmitButton}from"../../../../core/utils/dom/elements.js";import ManageUser from"../../models/ManageUser.js";import populateDateTimeForm from"./components/date-time/populateDateTimeForm.js";const COMPONENT_ID="date-time",manageUser=new ManageUser,timeZone=document.getElementById("time-zone"),dateFormat=document.getElementById("date-format");async function handleFormSubmission(e){e.preventDefault();try{if(safeDisplayMessage({elementId:"form-msg",message:"Processing...",isSuccess:!0,color:"w3-text-blue"}),!validateForm(e.target))return;const t=Object.fromEntries(new FormData(e.target)),a=manageUser.getStoreNames(),o=await manageUser.updateLocalUserSettings({userData:t,settingsProperty:"date_time",backupStore:a.DATETIME,backupAPITag:"add_date_time"});safeDisplayMessage(o?{elementId:"form-msg",message:"Date/Time Options have been saved.",isSuccess:!0}:{elementId:"form-msg",message:"We were unable to save your Date/Time Options."})}catch(e){const{handleError:t}=await import("../../../../../../old-js-code/js/utils/error-messages/handleError.js");await t({filename:"dateTimeFormError",consoleMsg:"Date/Time form submission error: ",err:e,userMsg:"Unable to save date/time options",errorEle:"form-msg"})}}function validateForm(e){const t=validateDateFormat({value:e.date_format.value,errorContainer:"date-format-error",inputContainer:"date-format"}),a=validateTimeZone({value:e.time_zone.value,errorContainer:"time-zone-error",inputContainer:"time-zone"});return t&&a}function validateDateFormat({value:e,errorContainer:t,inputContainer:a}){const o=["Y-m-d","m-d-Y","d-m-Y"];for(const r of o)if(r===e)return clearMsg({container:t,input:a}),disableEnableSubmitButton("submit-button"),!0;return safeDisplayMessage({elementId:t,message:"Please select a valid date format."}),disableEnableSubmitButton("submit-button"),!1}function validateTimeZone({value:e,errorContainer:t,inputContainer:a}){const o={"America/New_York":"Eastern Time Zone","America/Chicago":"Central Time Zone","America/Denver":"Mountain Time Zone","America/Phoenix":"Mountain Time No DST","America/Los_Angeles":"Pacific Time Zone","America/Anchorage":"Alaska Time Zone"};let r=!1;for(const t in o)if(t.toLowerCase()===e.toLowerCase()){r=!0;break}return r?(clearMsg({container:t,input:a}),disableEnableSubmitButton("submit-button"),!0):(safeDisplayMessage({elementId:t,message:"Please select a valid time zone.",targetId:a}),disableEnableSubmitButton("submit-button"),!1)}populateDateTimeForm(manageUser,{timeZone:timeZone,dateFormat:dateFormat}),addListener({elementOrId:"date-time-form",eventType:"submit",handler:handleFormSubmission,componentId:"date-time"});