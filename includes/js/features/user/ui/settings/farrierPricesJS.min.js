// @ts-nocheck
import openModal from"../../../../core/services/modal/openModal.js";import{getValidElement}from"../../../../core/utils/dom/elements.js";import{addListener}from"../../../../core/utils/dom/listeners.js";import{safeDisplayMessage}from"../../../../core/utils/dom/messages.js";import{top}from"../../../../core/utils/window/scroll.js";import ManageUser from"../../models/ManageUser.js";import displayMultipleInputs from"./components/farrier-prices/displayMultipleInputs.js";import makeInputsGreen from"./components/farrier-prices/makeInputsGreen.js";import populateFarrierPricesForm from"./components/farrier-prices/populateFarrierPricesForm.js";import seperateFarrierPricesFromAccessories from"./components/farrier-prices/seperateFarrierPricesFromAccessories.js";const COMPONENT="Farrier Prices",DEBUG=!1,debugLog=(...e)=>{false},COMPONENT_ID="farrier-prices",FARRIER_PRICES_FORM="farrier-prices-form",manageUser=new ManageUser;async function init(){await Promise.all([populateFarrierPricesForm({form:FARRIER_PRICES_FORM,manageUser:manageUser,componentId:COMPONENT_ID}),displayMultipleInputs(FARRIER_PRICES_FORM,COMPONENT_ID),makeInputsGreen({form:FARRIER_PRICES_FORM,componentId:COMPONENT_ID})]);const e={"click:info-icon":e=>{showTrimmingInfoInModal({iconId:"trimming-help-info",title:"Trimming Pricing Information"})},"click:accessory-info-icon":e=>{showTrimmingInfoInModal({iconId:"accessory-help-info",title:"Accessory Pricing Information"})},"submit:farrier-prices-form":async e=>{e.preventDefault(),async function(e){e.preventDefault();try{const r=manageUser.getStoreNames(),o=Object.fromEntries(new FormData(e.target));debugLog();const s=await seperateFarrierPricesFromAccessories(o);debugLog();await manageUser.updateLocalUserSettings({userData:s,settingsProperty:"farrier_prices",backupStore:r.FARRIERPRICES,backupAPITag:"add_farrierPrices"})&&(top(),safeDisplayMessage({elementId:"form-msg",message:"Your pricing has been set.",isSuccess:!0}))}catch(e){const{AppError:r}=await import("../../../../core/errors/models/AppError.js");r.handleError(e,{errorCode:r.Types.FORM_SUBMISSION_ERROR,userMessage:"Unable to save pricing.",displayTarget:"form-msg"})}}(e)}};addListener({elementOrId:FARRIER_PRICES_FORM,eventType:["click","submit"],handler:r=>{debugLog(r.target);const o=`${r.type}:${r.target.id}`||`${r.type}:${r.target.parentElement.id}`;debugLog(),e[o]&&e[o](r)},componentId:COMPONENT_ID})}function showTrimmingInfoInModal({iconId:e,title:r}){const o=getValidElement(e),s=o.innerHTML;debugLog(),openModal({title:r,content:s,configuration:["w3-padding","w3-round-large","w3-white","w3-margin","w3-margin-center"]})}init();