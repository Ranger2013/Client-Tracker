// @ts-nocheck
import{formatDate,formatTime}from"../../../../../core/utils/date/dateUtils.min.js";import{buildEle,getValidElement}from"../../../../../core/utils/dom/elements.js";import{cleanUserOutput}from"../../../../../core/utils/string/stringUtils.js";const COMPONENT="Show Client Selection",DEBUG=!1,debugLog=(...e)=>{false};export default async function showClientSelection({evt:e,duplicateClients:t,manageUser:a}){try{const i=getDuplicateClients({cID:parseInt(e.target.value,10),clientData:t});renderPage(await buildDuplicateClientSectionView({duplicatesData:i,manageUser:a}))}catch(e){const{AppError:t}=await import("../../../../../core/errors/models/AppError.js");t.process(e,{errorCode:t.Types.RENDER_ERROR,userMessage:t.BaseMessages.system.render,displayTarget:"client-container"},!0)}}function getDuplicateClients({cID:e,clientData:t}){return t.filter((t=>t.cID===e))}async function buildDuplicateClientSectionView({duplicatesData:e,manageUser:t}){if(0===e.length)throw new Error("No duplicate clients found");const a=document.createDocumentFragment(),{date_format:i,time_format:l}=await t.getDateTimeOptions();let n=1;return e.forEach((e=>{const t=buildEle({type:"div",attributes:{id:`client-section-${n}`},myClass:["w3-section","w3-border","w3-card","w3-round"]}),r=buildEle({type:"div",myClass:["w3-blue-grey","w3-border-bottom","w3-padding","w3-bold"],text:cleanUserOutput(e.client_name)}),s=buildEle({type:"div",myClass:["w3-row"]}),o=buildEle({type:"div",myClass:["w3-col","s8","w3-padding-small"]}),d=buildEle({type:"div",myClass:["w3-row"]}),c=buildEle({type:"div",myClass:["w3-col","m4","w3-bold"],text:"Appointment: "}),p=buildEle({type:"div",myClass:["w3-col","m8"],text:`${formatDate(e.trim_date,i)} at ${formatTime(e.app_time,l)}`}),m=buildEle({type:"div",myClass:["w3-col","s4","w3-padding-small","w3-center"]}),u=buildEle({type:"button",attributes:{id:`delete-button-${n}`,"data-primarykey":e.primaryKey,"data-cid":e.cID},myClass:["w3-button","w3-red","w3-round"],text:"Delete"});m.appendChild(u),d.append(c,p),o.append(d),s.append(o,m),t.append(r,s),a.appendChild(t),n++})),a}function renderPage(e){const t=getValidElement("client-container");t.innerHTML="",t.appendChild(e)}